<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Every Survey Website</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            inter: ['Inter', 'sans-serif'],
          },
          colors: {
            brand: {
              blue: '#4f46e5',
              green: '#10b981',
              orange: '#f59e0b'
            }
          }
        },
      },
    };
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

    body {
      font-family: 'Inter', sans-serif;
      transition: background-color 0.3s ease;
      background: linear-gradient(135deg, rgba(249, 250, 251, 0.9) 0%, rgba(228, 232, 255, 0.9) 100%);
    }

    .dark body {
      background: linear-gradient(135deg, rgba(17, 24, 39, 0.95) 0%, rgba(30, 41, 59, 0.95) 100%);
    }

    /* Card styling */
    .card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border-radius: 12px;
      overflow: hidden;
      height: 100%;
      position: relative;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1), 0 6px 6px rgba(0, 0, 0, 0.06);
    }

    .card-container {
      position: relative;
      height: 100%;
      perspective: 1500px;
    }

    .card-front, .card-back {
      backface-visibility: hidden;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      border-radius: 12px;
      overflow: hidden;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    .card-back {
      transform: rotateY(180deg);
    }

    .card-front.flipped {
      transform: rotateY(-180deg);
    }
    
    /* Adjust card container when flipped */
    .card-container.flipped {
      min-height: 500px;
      z-index: 10;
      transform: translateY(-5px);
      transition: all 0.3s ease;
    }

    .card-back.flipped {
      transform: rotateY(0deg);
      min-height: 500px;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    /* Button effects */
    .signup-btn, .details-btn, .review-btn {
      transition: all 0.2s ease;
      overflow: hidden;
      position: relative;
    }

    .signup-btn:hover, .review-btn:hover, .details-btn:hover {
      transform: translateY(-2px);
    }

    .signup-btn:active, .review-btn:active, .details-btn:active {
      transform: translateY(0);
    }

    /* Rating icons styling */
    .ratings i.fa-star, .ratings i.fab {
      font-size: 0.9rem;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }

    ::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #555;
    }

    .dark ::-webkit-scrollbar-track {
      background: #1f2937;
    }

    .dark ::-webkit-scrollbar-thumb {
      background: #4b5563;
    }

    .dark ::-webkit-scrollbar-thumb:hover {
      background: #6b7280;
    }

    /* Payment info styling */
    .min-payout, .avg-pay {
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .min-payout:hover, .avg-pay:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    /* Theme toggle button */
    .theme-toggle {
      transition: all 0.3s ease;
    }

    .theme-toggle:hover {
      transform: rotate(15deg);
    }

    /* Search input effect */
    .search-input {
      transition: all 0.3s ease;
    }

    .search-input:focus {
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
      transform: scale(1.01);
    }

    /* Card detail tags */
    .payment-method, .feature {
      transition: all 0.2s ease;
    }

    .payment-method:hover, .feature:hover {
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    /* Fancy gradient effects */
    @media (prefers-reduced-motion: no-preference) {
      .bg-gradient-to-r {
        background-size: 200% auto;
        transition: background-position 0.5s ease;
      }
      
      .bg-gradient-to-r:hover {
        background-position: right center;
      }
    }

    /* Animation for new cards */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    #cardContainer > div {
      animation: fadeIn 0.5s ease-out backwards;
    }

    #cardContainer > div:nth-child(1) { animation-delay: 0.05s; }
    #cardContainer > div:nth-child(2) { animation-delay: 0.1s; }
    #cardContainer > div:nth-child(3) { animation-delay: 0.15s; }
    #cardContainer > div:nth-child(4) { animation-delay: 0.2s; }
    #cardContainer > div:nth-child(5) { animation-delay: 0.25s; }
    #cardContainer > div:nth-child(6) { animation-delay: 0.3s; }
    #cardContainer > div:nth-child(7) { animation-delay: 0.35s; }
    #cardContainer > div:nth-child(8) { animation-delay: 0.4s; }
    #cardContainer > div:nth-child(9) { animation-delay: 0.45s; }

    /* Responsive adjustments */
    @media (max-width: 640px) {
      .ratings {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.25rem;
      }
      
      .action-buttons {
        grid-template-columns: 1fr;
      }
    }

    /* Back button animation */
    .back-btn {
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .back-btn:hover {
      transform: rotate(90deg);
      background-color: rgba(0, 0, 0, 0.05);
    }

    /* Card content sections hover effects */
    .card-back .bg-gray-100, 
    .card-back .bg-indigo-50,
    .card-back .bg-emerald-50,
    .card-back .bg-amber-50,
    .card-back .bg-purple-50 {
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .card-back .bg-gray-100:hover, 
    .card-back .bg-indigo-50:hover,
    .card-back .bg-emerald-50:hover,
    .card-back .bg-amber-50:hover,
    .card-back .bg-purple-50:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    }

    /* Dark mode adjustments */
    .dark .card-back .bg-gray-100:hover,
    .dark .card-back .bg-indigo-900:hover,
    .dark .card-back .bg-emerald-900:hover,
    .dark .card-back .bg-amber-900:hover,
    .dark .card-back .bg-purple-900:hover {
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
    }

    .card-container {
      position: relative;
      height: 100%;
      perspective: 1500px;
      min-height: 200px;
    }
  </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100">
  <div class="container mx-auto px-4 py-8">
    <!-- Header with logo and theme toggle -->
    <header class="mb-8">
      <div class="flex justify-between items-center">
        <div class="flex items-center space-x-3">
          <div class="bg-gradient-to-br from-blue-600 to-purple-600 p-3 rounded-lg shadow-md">
            <i class="fas fa-poll text-white text-2xl"></i>
          </div>
          <h1 class="text-3xl font-bold">Every Survey Website</h1>
        </div>
        <button id="themeToggle" class="theme-toggle p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none">
          <i class="fas fa-sun text-yellow-500 dark:hidden text-xl"></i>
          <i class="fas fa-moon text-blue-300 hidden dark:inline text-xl"></i>
        </button>
      </div>
    </header>
    <!-- Search box -->
    <div class="relative mb-8 max-w-xl mx-auto">
      <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
        <i class="fas fa-search text-gray-400"></i>
      </div>
      <input
        id="searchInput"
        type="text"
        placeholder="Search for a survey website..."
        class="search-input w-full pl-10 pr-4 py-4 bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-700 rounded-xl shadow-sm focus:outline-none focus:border-blue-500 dark:focus:border-blue-400 transition-colors"
      />
    </div>
    <!-- Card container -->
    <div id="cardContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- Cards will be rendered here by JavaScript -->
      <div class="col-span-full flex flex-col items-center justify-center py-12">
        <div class="text-gray-500 dark:text-gray-400 text-center">
          <i class="fas fa-spinner fa-spin text-4xl mb-3"></i>
          <p>Loading survey websites...</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    let surveyData = [];

    // Theme toggle functionality
    const themeToggle = document.getElementById('themeToggle');
    
    // Toggle theme
    themeToggle.addEventListener('click', () => {
      if (document.documentElement.classList.contains('dark')) {
        document.documentElement.classList.remove('dark');
        localStorage.setItem('theme', 'light');
      } else {
        document.documentElement.classList.add('dark');
        localStorage.setItem('theme', 'dark');
      }
    });

    // Fetch and render survey data
    console.log('Fetching data from data.json...');
    fetch('data.json')
      .then(response => {
        console.log('Response received:', response.status);
        return response.json();
      })
      .then(data => {
        console.log('Data loaded successfully, items:', data.length);
        surveyData = data;
        renderCards();
      })
      .catch(error => {
        console.error('Error loading data:', error);
        // Show error message in the UI
        const cardContainer = document.getElementById('cardContainer');
        if (cardContainer) {
          cardContainer.innerHTML = `
            <div class="col-span-full flex flex-col items-center justify-center py-12">
              <div class="text-red-500 dark:text-red-400 text-center">
                <i class="fas fa-exclamation-triangle text-4xl mb-3"></i>
                <p>Error loading data. Please try again later.</p>
                <p class="text-sm mt-2">${error.message}</p>
              </div>
            </div>
          `;
        }
      });

    function renderCards() {
      const searchInput = document.getElementById('searchInput');
      const searchTerm = searchInput ? searchInput.value.toLowerCase() : '';
      const cardContainer = document.getElementById('cardContainer');
      
      if (!cardContainer) return;
      
      // Clear the container including the loading state
      cardContainer.innerHTML = '';

      const filteredData = surveyData.filter(item => 
        item['Website Name'].toLowerCase().includes(searchTerm)
      );

      // Show no results message if no data matches
      if (filteredData.length === 0) {
        const noResults = document.createElement('div');
        noResults.className = 'col-span-full flex flex-col items-center justify-center py-12';
        noResults.innerHTML = `
          <div class="text-gray-500 dark:text-gray-400 text-center">
            <i class="fas fa-search text-4xl mb-3 text-gray-400 dark:text-gray-600"></i>
            <p>No survey websites found matching "${searchTerm}"</p>
          </div>
        `;
        cardContainer.appendChild(noResults);
        return;
      }

      filteredData.forEach(item => {
        // Create card container with flip functionality
        const cardContainer = document.createElement('div');
        cardContainer.className = 'card-container';
        
        // Create the card with front and back sides
        const card = document.createElement('div');
        card.className = 'card relative';
        
        const cardFront = document.createElement('div');
        cardFront.className = 'card-front bg-white dark:bg-slate-800 rounded-xl shadow-lg overflow-hidden transition-all duration-300 border border-gray-200 dark:border-slate-700 hover:shadow-xl';
        
        const cardBack = document.createElement('div');
        cardBack.className = 'card-back bg-white dark:bg-slate-800 rounded-xl shadow-lg overflow-hidden transition-all duration-300 border border-gray-200 dark:border-slate-700 hover:shadow-xl';
        
        // Get ratings, handle "Not listed" cases
        const trustpilot = item['Trustpilot Ratings'] !== 'Not listed' ? item['Trustpilot Ratings'] : '-';
        const appStore = item['App Store Ratings'] !== 'Not listed' ? item['App Store Ratings'] : '-';
        const googlePlay = item['Google Play Ratings'] !== 'Not listed' ? item['Google Play Ratings'] : '-';

        // Calculate average pay for display
        const minPay = item['Average Pay Per Survey']?.['Min'] || 'Varies';
        const maxPay = item['Average Pay Per Survey']?.['Max'] || 'Varies';
        
        // Min payout value
        const minPayout = item['Minimum Payout']?.['PayPal'] || 
                          item['Minimum Payout']?.['Gift Cards'] || 
                          item['Minimum Payout']?.['Bank Transfer'] || 
                          item['Minimum Payout']?.['Other'] || 
                          'Varies';

        // No inline styles needed
        
        // Populate front of card with the new design
        cardFront.innerHTML = `
          <!-- Top section with name and ratings -->
          <div class="site-header bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-slate-800 dark:to-slate-900 border-b border-gray-200 dark:border-slate-700 rounded-t-lg p-3 mb-3">
            <div class="flex justify-between items-center">
              <h2 class="text-xl font-bold text-gray-800 dark:text-white">${item['Website Name']}</h2>
              <div class="ratings flex space-x-4">
                <div class="flex items-center" title="Trustpilot rating">
                  <i class="fas fa-star text-green-500 mr-1"></i>
                  <span class="font-semibold text-gray-800 dark:text-white">${trustpilot}</span>
                </div>
                <div class="flex items-center" title="App Store rating">
                  <i class="fab fa-apple text-gray-800 dark:text-white mr-1"></i>
                  <span class="font-semibold text-gray-800 dark:text-white">${appStore}</span>
                </div>
                <div class="flex items-center" title="Google Play rating">
                  <i class="fab fa-google-play text-blue-500 mr-1"></i>
                  <span class="font-semibold text-gray-800 dark:text-white">${googlePlay}</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Payment info boxes -->
          <div class="payment-info grid grid-cols-2 gap-3 px-4 mb-3">
            <div class="min-payout bg-indigo-50 dark:bg-indigo-900/50 rounded-lg p-3 text-center">
              <div class="text-xs text-gray-800 dark:text-gray-200 font-medium mb-1">Min. Payout</div>
              <div class="font-bold flex items-center justify-center text-gray-800 dark:text-white">
                <i class="fas fa-coins text-amber-500 mr-2"></i>
                <span>${minPayout}</span>
              </div>
            </div>
            <div class="avg-pay bg-emerald-50 dark:bg-emerald-900/50 rounded-lg p-3 text-center">
              <div class="text-xs text-gray-800 dark:text-gray-200 font-medium mb-1">Pay Per Survey</div>
              <div class="font-bold flex items-center justify-center text-gray-800 dark:text-white">
                <i class="fas fa-sack-dollar text-emerald-500 mr-2"></i>
                <span>${minPay} - ${maxPay}</span>
              </div>
            </div>
          </div>

          <!-- Action buttons -->
          <div class="action-buttons ${item['Review'] && item['Review'] !== 'null' ? 'grid grid-cols-3 gap-2' : 'flex justify-between'} px-4 pb-1 pt-0">
            <a href="${item['Website URL']}" target="_blank" class="signup-btn bg-gradient-to-r from-brand-blue to-blue-500 text-white hover:from-brand-blue hover:to-blue-600 py-2 rounded-lg text-center font-bold transition-colors shadow-md ${item['Review'] && item['Review'] !== 'null' ? '' : 'flex-1 mr-2'}">
              <i class="fas fa-user-plus mr-1"></i> SIGN UP
            </a>
            
            <button class="details-btn bg-gradient-to-r from-gray-200 to-gray-300 dark:from-gray-700 dark:to-gray-800 text-gray-800 dark:text-white hover:from-gray-300 hover:to-gray-400 dark:hover:from-gray-600 dark:hover:to-gray-700 py-2 rounded-lg text-center font-bold transition-colors ${item['Review'] && item['Review'] !== 'null' ? '' : 'flex-1 ml-2'}">
              <i class="fas fa-info-circle mr-1"></i> DETAILS
            </button>
            
            ${item['Review'] && item['Review'] !== 'null' ? 
              `<a href="${item['Review']}" class="review-btn bg-gradient-to-r from-brand-orange to-yellow-500 text-white hover:from-brand-orange hover:to-yellow-600 py-2 rounded-lg text-center font-bold transition-colors shadow-md">
                <i class="fas fa-star-half-alt mr-1"></i> REVIEW
              </a>` : 
              ''}
          </div>
        `;
        
        // Populate back of card
        cardBack.innerHTML = `
          <div class="p-4">
            <div class="flex justify-between items-center mb-4">
              <h2 class="text-xl font-bold">${item['Website Name']} Details</h2>
              <button class="back-btn p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700">
                <i class="fas fa-times text-gray-500"></i>
              </button>
            </div>

            <div class="grid gap-2 text-sm">
              <div class="bg-gray-100 dark:bg-gray-700/50 p-3 rounded-lg">
                <h3 class="font-semibold text-gray-800 dark:text-gray-200 mb-2 text-sm">Registration Requirements</h3>
                <ul class="list-disc list-inside">
                  <li>Age: ${item['Registration Requirements']?.['Age'] || 'Not specified'}</li>
                  <li>Region: ${item['Registration Requirements']?.['Region'] || 'Not specified'}</li>
                  <li>Verification: ${Array.isArray(item['Registration Requirements']?.['Verification']) ? 
                    item['Registration Requirements']?.['Verification'].join(', ') : 
                    (item['Registration Requirements']?.['Verification'] || 'Not specified')}</li>
                </ul>
              </div>

              <div class="bg-indigo-50 dark:bg-indigo-900/30 p-3 rounded-lg">
                <h3 class="font-semibold text-gray-800 dark:text-gray-200 mb-2 text-sm">Payment Methods</h3>
                <div class="flex flex-wrap gap-2">
                  ${Array.isArray(item['Payment Methods']) ? 
                    item['Payment Methods'].map(method => `
                      <span class="payment-method inline-flex items-center rounded-full bg-white dark:bg-gray-800 px-2.5 py-0.5 text-xs border border-gray-300 dark:border-gray-600">
                        <i class="mr-1 ${
                          method === 'PayPal' ? 'fab fa-paypal text-blue-500' : 
                          method === 'Gift Cards' ? 'fas fa-gift text-red-500' : 
                          method === 'Crypto' ? 'fab fa-bitcoin text-orange-500' : 
                          method === 'Bank Transfer' ? 'fas fa-university text-green-700' : 
                          'fas fa-money-bill-wave text-green-500'
                        }"></i>
                        ${method}
                      </span>
                    `).join('') : 
                    'Not specified'}
                </div>
              </div>

              <div class="bg-emerald-50 dark:bg-emerald-900/30 p-3 rounded-lg">
                <h3 class="font-semibold text-gray-800 dark:text-gray-200 mb-2 text-sm">Survey Frequency</h3>
                <div class="flex items-center">
                  <i class="fas fa-calendar-alt text-emerald-600 dark:text-emerald-400 mr-2"></i>
                  <span>${item['Survey Frequency'] || 'Not specified'}</span>
                </div>
              </div>

              ${item['Referral Program']?.['Earnings'] ? `
                <div class="bg-amber-50 dark:bg-amber-900/30 p-3 rounded-lg">
                  <h3 class="font-semibold text-gray-800 dark:text-gray-200 mb-2 text-sm">Referral Program</h3>
                  <div class="flex items-center">
                    <i class="fas fa-user-friends text-amber-600 dark:text-amber-400 mr-2"></i>
                    <span>${item['Referral Program']['Earnings']}</span>
                  </div>
                </div>
              ` : ''}

              ${item['Special Features']?.['Features']?.length > 0 ? `
                <div class="bg-purple-50 dark:bg-purple-900/30 p-3 rounded-lg">
                  <h3 class="font-semibold text-gray-800 dark:text-gray-200 mb-2 text-sm">Special Features</h3>
                  <div class="flex flex-wrap gap-2">
                    ${Array.isArray(item['Special Features']['Features']) ? 
                      item['Special Features']['Features'].map(feature => `
                        <span class="feature inline-flex items-center rounded-full bg-white dark:bg-gray-800 px-2.5 py-0.5 text-xs border border-gray-300 dark:border-gray-600">
                          <i class="fas fa-check-circle text-purple-500 mr-1"></i>
                          ${feature}
                        </span>
                      `).join('') : 
                      'None'}
                  </div>
                </div>
              ` : ''}
            </div>

            <div class="mt-3">
              <a href="${item['Website URL']}" target="_blank" class="block w-full bg-gradient-to-r from-brand-blue to-blue-500 text-white hover:from-brand-blue hover:to-blue-600 py-2 rounded-lg text-center font-bold transition-colors shadow-md">
                <i class="fas fa-external-link-alt mr-2"></i>VISIT WEBSITE
              </a>
            </div>
          </div>
        `;

        // Add card elements to DOM
        card.appendChild(cardFront);
        card.appendChild(cardBack);
        cardContainer.appendChild(card);
        
        // Add event listeners for details button
        cardContainer.querySelector('.details-btn').addEventListener('click', () => {
          cardFront.classList.add('flipped');
          cardBack.classList.add('flipped');
          cardContainer.classList.add('flipped');
        });
        
        // Add event listener for back button
        if (cardContainer.querySelector('.back-btn')) {
          cardContainer.querySelector('.back-btn').addEventListener('click', () => {
            cardFront.classList.remove('flipped');
            cardBack.classList.remove('flipped');
            cardContainer.classList.remove('flipped');
          });
        }
        
        // For Sign Up button, create a redirect
        const signupBtn = cardContainer.querySelector('.signup-btn');
        if (signupBtn) {
          signupBtn.addEventListener('click', (e) => {
            e.preventDefault();
            const targetUrl = e.currentTarget.getAttribute('href');
            const encodedUrl = btoa(targetUrl);
            window.location.href = `redirect.html?go=${encodedUrl}`;
          });
        }
        
        // Add the card container to the main container
        document.getElementById('cardContainer').appendChild(cardContainer);
      });
    }

    // For backward compatibility - this function is no longer used directly
    function cloackLink(websiteName, url) {
      console.log(`Cloaking link for: ${websiteName}`);
      localStorage.setItem('redirectURL', url);
      localStorage.setItem(`lastClicked_${websiteName}`, new Date().toISOString());
      
      // Redirect to the proper URL format
      window.location.href = `redirect.html?go=${btoa(url)}`;
    }

    // Event listener for search input
    document.addEventListener('DOMContentLoaded', () => {
      const searchInput = document.getElementById('searchInput');
      if (searchInput) {
        searchInput.addEventListener('input', renderCards);
      }
    });
  </script>
</body>
</html>